name: Provision S3 Bucket
on: workflow_dispatch
inputs:
  bucketName:
    description: 'Name of the S3 bucket'
    required: true
    type: string
  region:
    description: 'AWS Region'
    required: true
    type: string
jobs:
  create-bucket:
    runs-on: ubuntu-latest
    steps:
      - name: Install AWS CLI
        run: | 
          sudo apt-get update
          sudo apt-get install -y awscli
      - name: Configure AWS Credentials
        # Replace with your actual credentials or use IAM roles
        run: aws configure set aws_access_key_id "YOUR_ACCESS_KEY"
        run: aws configure set aws_secret_access_key "YOUR_SECRET_KEY"
        run: aws configure set default.region ${{ inputs.region }}
      - name: Create S3 Bucket
        run: aws s3api create-bucket --bucket ${{ inputs.bucketName }} --region ${{ inputs.region }} --create-bucket-configuration LocationConstraint=${{ inputs.region }}
      - name: Set Bucket Policy (Optional)
        # Add your bucket policy here if needed
        run: |
          # Example policy to make bucket public
          # aws s3api put-bucket-policy --bucket ${{ inputs.bucketName }} --policy file://policy.json
          echo "Bucket policy not set"
      - name: Output Bucket Name
        run: echo "S3 Bucket '${{ inputs.bucketName }}' created successfully in region '${{ inputs.region }}'"
